{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"C:/django-react/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/django-react/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router';import CKEditor from'ckeditor4-react';import{Form}from\"react-bootstrap\";import'../views/Boardwrite.css';import MenuItem from'@material-ui/core/MenuItem';import FormControl from'@material-ui/core/FormControl';var titleStyle={marginBottom:9,width:300};function Boardwrite(){var _useState=useState([{id:1,infomation:'챌린저'},{id:2,infomation:'그랜드마스터'},{id:3,infomation:'마스터'},{id:4,infomation:'다이아몬드'},{id:5,infomation:'플레티넘'},{id:6,infomation:'골드'},{id:7,infomation:'실버'},{id:8,infomation:'브론즈'},{id:9,infomation:'아이언'}]),_useState2=_slicedToArray(_useState,1),filterList=_useState2[0];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),InfomationfilterList=_useState4[0],setInfomationFilterList=_useState4[1];var Today=new Date();var date=Today.getFullYear()+\"-\"+Today.getMonth()+\"-\"+Today.getDate();var history=useHistory();var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];var _useState7=useState(\"내용을 입력하세요.\"),_useState8=_slicedToArray(_useState7,2),content=_useState8[0],setContent=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),userPhoto=_useState10[0],setUserPhoto=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),user_id=_useState12[0],setUser_id=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),userNickname=_useState14[0],setUserNickname=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),usergrade=_useState16[0],setUserGrade=_useState16[1];var sendData;var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),urls=_useState18[0],setUrls=_useState18[1];var handleEffect=function handleEffect(handleSubmit){if(InfomationfilterList===\"\"||InfomationfilterList.length===0){alert(\"한 개 이상의 언어를 선택해주세요.\");return;}sendData={title:title,content:content,date:date,like:0,nickname:userNickname,infomation:InfomationfilterList,profileImage:userPhoto,user_id:user_id,grade:usergrade};handleSubmit();};var handleSubmit=function handleSubmit(){var form_data=new FormData();form_data.append('category',sendData.grade);form_data.append('title',sendData.title);form_data.append('contents',sendData.content);form_data.append('pub_date',sendData.date);form_data.append('infomation',sendData.infomation);form_data.append('like',sendData.like);form_data.append('nickname',sendData.nickname);form_data.append('profileImage',sendData.profileImage);form_data.append('user_id',sendData.user_id);fetch(\"http://39.118.174.168:8000/board/\"+urls,{method:'POST',headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))},body:form_data}).then(function(res){return res.json();}).catch(function(error){return console.error('Error:',error);}).then(function(response){return console.log('Success:',JSON.stringify(response));}).then(history.push(\"/\"));// .then(history.go(0));\n};useEffect(function(){fetch('http://39.118.174.168:8000/api/current_user/',{headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){return res.json();}).then(function(json){if(json.id===null||json.id===undefined){alert(\"로그인이 필요합니다.\");// history.push('/')\n}fetch('http://39.118.174.168:8000/api/profile/'+json.id+'/update/',{method:'PATCH',headers:{Authorization:\"JWT \".concat(localStorage.getItem('token'))}}).then(function(res){return res.json();}).then(function(userData){setUserPhoto(userData.photo);setUser_id(userData.user_id);setUserNickname(userData.nickname);setUserGrade(userData.grade);if(userData.grade===4){setUserGrade(\"일반 수강생\");setUrls(\"student/\");}else if(userData.grade===3){setUserGrade(\"프리미엄 수강생\");setUrls(\"premiumst/\");}else if(userData.grade===2){setUserGrade(\"일반 파트너\");setUrls(\"partner/\");}else if(userData.grade===1){setUserGrade(\"프리미엄 파트너\");setUrls(\"premium/\");}else{history.push('/profile');alert(\"티어인증이 필요합니다\");}}).catch(function(error){console.log(error);});}).catch(function(error){console.log(error);});},[history]);var ClickFilter=function ClickFilter(lang){var Num=0;var List=_toConsumableArray(InfomationfilterList);List.map(function(a){if(a===lang){Num=1;}return Num;});if(Num===0){List.push(lang);}else{List.splice(List.indexOf(lang),1);}setInfomationFilterList(List);};var handleChange=function handleChange(event){console.log(event.editor.getData());setContent(event.editor.getData());// setContent(event.target.value);\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uAE00\\uC4F0\\uAE30\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FormControl,{className:\"MenuItem\",children:/*#__PURE__*/_jsxs(MenuItem,{children:[\"\\uAC8C\\uC2DC\\uD310 : \",usergrade]})}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",style:titleStyle,placeholder:\"\\uC81C\\uBAA9\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694\",onChange:function onChange(e){setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(CKEditor,{value:content,onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{className:\"upButton\",onClick:function onClick(){handleEffect(handleSubmit);},children:\"\\uCD9C\\uAC04\\uD558\\uAE30\"})]}),/*#__PURE__*/_jsx(\"aside\",{className:\"pDRpRs\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"eyrfCGs\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"filter__heads\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyleType:\"none\"},children:filterList.map(function(a){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"input\",{id:a.infomation,className:\"filters-input__checkboxs\",value:\"action\",type:\"checkbox\",\"data-type\":\"genres\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"input__labels\",htmlFor:a.infomation,onClick:function onClick(){ClickFilter(a.infomation);},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\" \",a.infomation,\" \"]}),/*#__PURE__*/_jsx(\"span\",{className:\"filters-input__ticks\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"13\",height:\"13\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#check\",children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",id:\"check\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436L24 5.782z\"})})})})})]})]},a.id);})})]})})]});}export default Boardwrite;","map":{"version":3,"sources":["C:/django-react/frontend/src/views/Boardwrite.js"],"names":["React","useState","useEffect","useHistory","CKEditor","Form","MenuItem","FormControl","titleStyle","marginBottom","width","Boardwrite","id","infomation","filterList","InfomationfilterList","setInfomationFilterList","Today","Date","date","getFullYear","getMonth","getDate","history","title","setTitle","content","setContent","userPhoto","setUserPhoto","user_id","setUser_id","userNickname","setUserNickname","usergrade","setUserGrade","sendData","urls","setUrls","handleEffect","handleSubmit","length","alert","like","nickname","profileImage","grade","form_data","FormData","append","fetch","method","headers","Authorization","localStorage","getItem","body","then","res","json","catch","error","console","response","log","JSON","stringify","push","undefined","userData","photo","ClickFilter","lang","Num","List","map","a","splice","indexOf","handleChange","event","editor","getData","e","target","value","listStyleType"],"mappings":"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","sourcesContent":["import React, { useState, useEffect} from 'react';\r\nimport { useHistory } from 'react-router'\r\nimport CKEditor from 'ckeditor4-react';\r\nimport {Form} from \"react-bootstrap\";\r\nimport '../views/Boardwrite.css';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\n\r\n\r\n\r\n\r\n  const titleStyle = {\r\n     marginBottom: 9,\r\n     width: 300\r\n   };\r\n\r\n   \r\nfunction Boardwrite() {\r\n\r\n\r\n  let [filterList] = useState([{id : 1, infomation: '챌린저'}, {id : 2, infomation : '그랜드마스터'},\r\n    {id : 3, infomation : '마스터'}, {id : 4, infomation :'다이아몬드'}, {id : 5, infomation:'플레티넘'},\r\n    {id : 6, infomation:'골드'}, {id : 7, infomation:'실버'}, {id : 8, infomation:'브론즈'}, {id : 9, infomation:'아이언'}])\r\n    let [InfomationfilterList, setInfomationFilterList] = useState(\"\")\r\n    \r\n    let Today = new Date();\r\n    let date = Today.getFullYear() + \"-\" + Today.getMonth() + \"-\" + Today.getDate()\r\n    \r\n\r\n    const history = useHistory()\r\n    let [title , setTitle] = useState(\"\")\r\n    let [content , setContent] = useState(\"내용을 입력하세요.\")\r\n    let [userPhoto, setUserPhoto] = useState()\r\n    let [user_id, setUser_id] = useState()\r\n    let [userNickname, setUserNickname] = useState()\r\n    let [usergrade, setUserGrade] = useState()\r\n    let sendData;\r\n    let [urls, setUrls] = useState()\r\n    const handleEffect = (handleSubmit) => {\r\n        if(InfomationfilterList === \"\" || InfomationfilterList.length === 0){\r\n            alert(\"한 개 이상의 언어를 선택해주세요.\")\r\n            return;\r\n        }\r\n        sendData = {\r\n            title : title,\r\n            content : content,\r\n            date : date,\r\n            like : 0,\r\n            nickname : userNickname,\r\n            infomation : InfomationfilterList,\r\n            profileImage : userPhoto,\r\n            user_id : user_id,\r\n            grade : usergrade\r\n        }\r\n        handleSubmit()\r\n    }\r\n\r\n    const handleSubmit = () => {\r\n        let form_data = new FormData();\r\n        form_data.append('category', sendData.grade);\r\n        form_data.append('title', sendData.title);\r\n        form_data.append('contents', sendData.content);\r\n        form_data.append('pub_date', sendData.date);\r\n        form_data.append('infomation', sendData.infomation);\r\n        form_data.append('like', sendData.like);\r\n        form_data.append('nickname', sendData.nickname);\r\n        form_data.append('profileImage', sendData.profileImage)\r\n        form_data.append('user_id', sendData.user_id);\r\n        \r\n        fetch(\"http://39.118.174.168:8000/board/\"+urls, {\r\n            method : 'POST',\r\n            headers: {\r\n                Authorization : `JWT ${localStorage.getItem('token')}`,\r\n            },\r\n            body : form_data\r\n        })\r\n        .then(res => res.json())\r\n        .catch(error => console.error('Error:', error))\r\n        .then(response => console.log('Success:', JSON.stringify(response)))\r\n        .then(history.push(\"/\"))\r\n        // .then(history.go(0));\r\n    };\r\n\r\n    useEffect(()=>{\r\n        fetch('http://39.118.174.168:8000/api/current_user/', {\r\n          headers: {\r\n            Authorization: `JWT ${localStorage.getItem('token')}`\r\n          }\r\n        })\r\n        .then(res => res.json())\r\n        .then(json => {\r\n          if (json.id === null || json.id === undefined) {\r\n            alert(\"로그인이 필요합니다.\")\r\n            // history.push('/')\r\n        }fetch('http://39.118.174.168:8000/api/profile/' + json.id + '/update/',{\r\n                method : 'PATCH',\r\n                headers: {\r\n                    Authorization: `JWT ${localStorage.getItem('token')}`\r\n                },\r\n            })\r\n            .then((res)=>res.json())\r\n            .then((userData)=> {\r\n                setUserPhoto(userData.photo);\r\n                setUser_id(userData.user_id);\r\n                setUserNickname(userData.nickname);\r\n                setUserGrade(userData.grade);\r\n                if(userData.grade===4){\r\n                  setUserGrade(\"일반 수강생\");\r\n                  setUrls(\"student/\");\r\n                } else if(userData.grade===3){\r\n                  setUserGrade(\"프리미엄 수강생\");\r\n                  setUrls(\"premiumst/\");\r\n                } else if(userData.grade===2){\r\n                  setUserGrade(\"일반 파트너\");\r\n                  setUrls(\"partner/\");\r\n                } else if(userData.grade===1){\r\n                  setUserGrade(\"프리미엄 파트너\");\r\n                  setUrls(\"premium/\");\r\n                } else{\r\n                  history.push('/profile');\r\n                  alert(\"티어인증이 필요합니다\");\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.log(error);\r\n              });\r\n        }).catch(error => {\r\n            console.log(error)\r\n          });\r\n    },[history])\r\n\r\n    const ClickFilter = (lang)=>{\r\n      let Num = 0;\r\n      let List = [...InfomationfilterList]\r\n      \r\n      List.map((a)=>{\r\n          if(a === lang){\r\n              Num = 1;\r\n          }\r\n          return Num;\r\n      })\r\n      if (Num === 0) {\r\n          List.push(lang)\r\n      }else{\r\n          List.splice(List.indexOf(lang),1)\r\n      }\r\n      setInfomationFilterList(List)\r\n  }\r\n  const handleChange = (event) => {\r\n    console.log(event.editor.getData())\r\n    setContent(event.editor.getData())\r\n    // setContent(event.target.value);\r\n  };\r\n\r\n\r\n  return (\r\n    <>\r\n            <div className=\"container-section\">\r\n              <h2>글쓰기</h2>\r\n              <div>\r\n              <FormControl className=\"MenuItem\">\r\n              <MenuItem>게시판 : {usergrade}</MenuItem>\r\n              </FormControl>\r\n              <Form.Control\r\n                 type = \"text\"\r\n                 style = {titleStyle}\r\n                 placeholder =\"제목을 입력하세요\"\r\n                 onChange = {(e)=>{setTitle(e.target.value)}}/>\r\n                \r\n              </div>\r\n                <CKEditor \r\n                 value = {content}\r\n                 onChange = {handleChange}/>\r\n\r\n                <button className=\"upButton\"\r\n                  onClick={()=>{\r\n                    handleEffect(handleSubmit) \r\n                  }}>\r\n\r\n                출간하기</button>\r\n            </div>\r\n                        \r\n\r\n          <aside className=\"pDRpRs\">\r\n            <div className=\"eyrfCGs\">\r\n              <div className=\"filter__heads\" />\r\n                <ul style={{ listStyleType: \"none\"}}>\r\n                 {\r\n                    filterList.map((a)=>{\r\n                        return(\r\n                        <li key={a.id}>\r\n                            <input id={a.infomation} className=\"filters-input__checkboxs\" value=\"action\" type=\"checkbox\" data-type=\"genres\"></input>\r\n                            <label className=\"input__labels\" htmlFor={a.infomation} onClick={()=>{ClickFilter(a.infomation)}}>\r\n                              <span> {a.infomation} </span>\r\n                               <span className=\"filters-input__ticks\">\r\n                                <svg \r\n                                width=\"13\"\r\n                                height=\"13\">\r\n                                <use xlinkHref=\"#check\">\r\n                                <svg viewBox=\"0 0 24 24\" id=\"check\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436L24 5.782z\"></path></svg>\r\n                                </use>\r\n                                </svg>\r\n                              </span>\r\n                            </label>\r\n                        </li>\r\n                        )\r\n                    })\r\n                  }\r\n                </ul>\r\n                \r\n               </div>  \r\n            </aside>\r\n                    \r\n    </>\r\n  )\r\n}\r\nexport default Boardwrite;"]},"metadata":{},"sourceType":"module"}